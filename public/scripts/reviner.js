// Generated by CoffeeScript 1.6.2
(function() {
  var root;

  root = typeof exports !== "undefined" && exports !== null ? exports : this;

  root.Reviner = {
    Models: {},
    Collections: {},
    Views: {}
  };

  window.timeSince = function(ts, now) {
    var days, delta, hou, min;

    ts = new Date(ts);
    delta = now.getTime() - ts.getTime();
    delta = delta / 1000;
    if (delta <= 59) {
      return Math.floor(delta) + "s";
    }
    if (delta >= 60 && delta <= 3599) {
      min = Math.floor(delta / 60);
      return min + "m";
    }
    if (delta >= 3600 && delta <= 86399) {
      hou = Math.floor(delta / 3600);
      return hou + "h";
    }
    if (delta >= 86400) {
      days = Math.floor(delta / 86400);
      return days + "d";
    }
  };

  $(function() {
    var metadata_template, post_template, viewEls, views;

    post_template = $('#post-template').html();
    metadata_template = $('#metadata-template').html();
    root.revines = new Reviner.Collections.Revines(Data.records);
    revines.on('add', function(revine) {
      return $('.overlay').show('slow', function() {
        return $('.overlay').delay(1500).hide('slow');
      });
    });
    views = [];
    revines.each(function(revine) {
      var revine_view;

      revine_view = new Reviner.Views.RevineView({
        model: revine,
        template: post_template,
        metadata_template: metadata_template
      });
      return views.push(revine_view.render());
    });
    viewEls = _.pluck(views, 'el');
    $('#container').html(viewEls);
    $('.footer').on('click', function() {
      return $('.shadow, .about').show();
    });
    return $('.shadow').on('click', function() {
      return $('.shadow, .about').hide();
    });
  });

}).call(this);
